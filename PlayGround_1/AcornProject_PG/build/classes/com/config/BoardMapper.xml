<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BoardMapper">
	
	<select id="recommendInfoBoardSelect" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = 'info'
		ORDER BY boardLiked DESC, boardCount DESC
	</select>
	
	<select id="hitInfoBoardSelect" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = 'info'
		ORDER BY boardCount DESC, boardLiked DESC
	</select>
	
	<select id="recommendQnaBoardSelect" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = 'QnA'
		ORDER BY boardLiked DESC, boardCount DESC
	</select>
	
	<select id="hitQnaBoardSelect" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = 'QnA'
		ORDER BY boardCount DESC, boardLiked DESC
	</select>
	
	<select id="boardSelect" parameterType="string" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = #{boardCategory}
		ORDER BY boardDate DESC
	</select>

	<!-- %넣기 -->
	<select id="boardTitleSearchSelect" parameterType="HashMap" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = #{boardCategory}
		AND boardName LIKE #{searchWord}
		ORDER BY boardDate DESC
	</select>

	<!-- %넣기 -->
	<select id="boardContentSearchSelect" parameterType="HashMap" resultType="BoardDTO">
		SELECT *
		FROM board
		WHERE boardCategory = #{boardCategory}
		AND boardContent LIKE #{searchWord}
		ORDER BY boardDate DESC
	</select>
	
	<insert id="boardInsert" parameterType="BoardDTO">
		INSERT INTO board(boardId,mbrId,boardCategory,boardName,boardContent,boardCount,boardLiked,boardDate) 
		VALUES(boardSeq.NEXTVAL,#{mbrId},#{boardCategory},#{boardName},#{boardContent},0,0,SYSDATE)
	</insert>
	
	<update id="boardUpdate" parameterType="BoardDTO">
		UPDATE board
		SET boardCategory = #{boardCategory}, boardName = #{boardName}, boardContent = #{boardContent}
		WHERE boardId = #{boardId}
	</update>
	
	<delete id="boardDelete" parameterType="int">
		DELETE FROM board
		WHERE boardId = #{boardId}
	</delete>
	
	<update id="boardLikeCount" parameterType="Hashmap">
		SELECT count(*)
        FROM liked
        WHERE boardId = #{boardId}
        AND mbrId = #{mbrId}
	</update>
	
	<update id="boardLikePlus" parameterType="string">
		UPDATE board
	     SET boardLiked = boardLiked + 1
	     WHERE boardId = #{boardId}
	</update>
	
	<update id="boardLikeMinus" parameterType="string">
		UPDATE board
	     SET boardLiked = boardLiked - 1
	     WHERE boardId = #{boardId}
	</update>
	
	<select id="boardDetailSelect" parameterType="string">
		SELECT *
		FROM board
		WHERE boardId = #{boardId}
	</select>
</mapper>